VERSION 2.00
Begin Form grouptri 
   Caption         =   "Groupes de tri"
   ClientHeight    =   2685
   ClientLeft      =   4245
   ClientTop       =   2460
   ClientWidth     =   3180
   FontBold        =   0   'False
   FontItalic      =   0   'False
   FontName        =   "MS Sans Serif"
   FontSize        =   8.25
   FontStrikethru  =   0   'False
   FontUnderline   =   0   'False
   Height          =   3090
   Icon            =   GROUPTRI.FRX:0000
   Left            =   4185
   LinkTopic       =   "Feuille3"
   MaxButton       =   0   'False
   MDIChild        =   -1  'True
   ScaleHeight     =   2685
   ScaleWidth      =   3180
   Top             =   2115
   Width           =   3300
   Begin PictureBox PopulationGroupe 
      AutoRedraw      =   -1  'True
      DragMode        =   1  'Automatic
      Height          =   255
      Index           =   10
      Left            =   2145
      ScaleHeight     =   225
      ScaleWidth      =   975
      TabIndex        =   42
      TabStop         =   0   'False
      Top             =   2400
      Width           =   1000
   End
   Begin TextBox CommentaireGroupe 
      FontBold        =   0   'False
      FontItalic      =   0   'False
      FontName        =   "MS Sans Serif"
      FontSize        =   8.25
      FontStrikethru  =   0   'False
      FontUnderline   =   0   'False
      Height          =   285
      Index           =   10
      Left            =   450
      TabIndex        =   41
      Top             =   2400
      Width           =   1695
   End
   Begin CheckBox CocheProjectionGroupe 
      Height          =   255
      Index           =   10
      Left            =   0
      TabIndex        =   40
      Top             =   2400
      Width           =   255
   End
   Begin PictureBox PopulationGroupe 
      AutoRedraw      =   -1  'True
      DragMode        =   1  'Automatic
      Height          =   255
      Index           =   9
      Left            =   2145
      ScaleHeight     =   225
      ScaleWidth      =   975
      TabIndex        =   38
      TabStop         =   0   'False
      Top             =   2160
      Width           =   1000
   End
   Begin TextBox CommentaireGroupe 
      FontBold        =   0   'False
      FontItalic      =   0   'False
      FontName        =   "MS Sans Serif"
      FontSize        =   8.25
      FontStrikethru  =   0   'False
      FontUnderline   =   0   'False
      Height          =   285
      Index           =   9
      Left            =   450
      TabIndex        =   37
      Top             =   2160
      Width           =   1695
   End
   Begin CheckBox CocheProjectionGroupe 
      Height          =   255
      Index           =   9
      Left            =   0
      TabIndex        =   36
      Top             =   2160
      Width           =   255
   End
   Begin PictureBox PopulationGroupe 
      AutoRedraw      =   -1  'True
      DragMode        =   1  'Automatic
      Height          =   255
      Index           =   8
      Left            =   2145
      ScaleHeight     =   225
      ScaleWidth      =   975
      TabIndex        =   34
      TabStop         =   0   'False
      Top             =   1920
      Width           =   1000
   End
   Begin TextBox CommentaireGroupe 
      FontBold        =   0   'False
      FontItalic      =   0   'False
      FontName        =   "MS Sans Serif"
      FontSize        =   8.25
      FontStrikethru  =   0   'False
      FontUnderline   =   0   'False
      Height          =   285
      Index           =   8
      Left            =   450
      TabIndex        =   33
      Top             =   1920
      Width           =   1695
   End
   Begin CheckBox CocheProjectionGroupe 
      Height          =   255
      Index           =   8
      Left            =   0
      TabIndex        =   32
      Top             =   1920
      Width           =   255
   End
   Begin PictureBox PopulationGroupe 
      AutoRedraw      =   -1  'True
      DragMode        =   1  'Automatic
      Height          =   255
      Index           =   7
      Left            =   2145
      ScaleHeight     =   225
      ScaleWidth      =   975
      TabIndex        =   30
      TabStop         =   0   'False
      Top             =   1680
      Width           =   1000
   End
   Begin TextBox CommentaireGroupe 
      FontBold        =   0   'False
      FontItalic      =   0   'False
      FontName        =   "MS Sans Serif"
      FontSize        =   8.25
      FontStrikethru  =   0   'False
      FontUnderline   =   0   'False
      Height          =   285
      Index           =   7
      Left            =   450
      TabIndex        =   29
      Top             =   1680
      Width           =   1695
   End
   Begin CheckBox CocheProjectionGroupe 
      Height          =   255
      Index           =   7
      Left            =   0
      TabIndex        =   28
      Top             =   1680
      Width           =   255
   End
   Begin PictureBox PopulationGroupe 
      AutoRedraw      =   -1  'True
      DragMode        =   1  'Automatic
      Height          =   255
      Index           =   6
      Left            =   2145
      ScaleHeight     =   225
      ScaleWidth      =   975
      TabIndex        =   26
      TabStop         =   0   'False
      Top             =   1440
      Width           =   1000
   End
   Begin TextBox CommentaireGroupe 
      FontBold        =   0   'False
      FontItalic      =   0   'False
      FontName        =   "MS Sans Serif"
      FontSize        =   8.25
      FontStrikethru  =   0   'False
      FontUnderline   =   0   'False
      Height          =   285
      Index           =   6
      Left            =   450
      TabIndex        =   25
      Top             =   1440
      Width           =   1695
   End
   Begin CheckBox CocheProjectionGroupe 
      Height          =   255
      Index           =   6
      Left            =   0
      TabIndex        =   24
      Top             =   1440
      Width           =   255
   End
   Begin PictureBox PopulationGroupe 
      AutoRedraw      =   -1  'True
      DragMode        =   1  'Automatic
      Height          =   255
      Index           =   5
      Left            =   2145
      ScaleHeight     =   225
      ScaleWidth      =   975
      TabIndex        =   22
      TabStop         =   0   'False
      Top             =   1200
      Width           =   1000
   End
   Begin TextBox CommentaireGroupe 
      FontBold        =   0   'False
      FontItalic      =   0   'False
      FontName        =   "MS Sans Serif"
      FontSize        =   8.25
      FontStrikethru  =   0   'False
      FontUnderline   =   0   'False
      Height          =   285
      Index           =   5
      Left            =   450
      TabIndex        =   21
      Top             =   1200
      Width           =   1695
   End
   Begin CheckBox CocheProjectionGroupe 
      Height          =   255
      Index           =   5
      Left            =   0
      TabIndex        =   20
      Top             =   1200
      Width           =   255
   End
   Begin CheckBox CocheProjectionGroupe 
      Enabled         =   0   'False
      Height          =   255
      Index           =   0
      Left            =   0
      TabIndex        =   14
      Top             =   0
      Value           =   2  'Grayed
      Width           =   255
   End
   Begin TextBox CommentaireGroupe 
      FontBold        =   0   'False
      FontItalic      =   0   'False
      FontName        =   "MS Sans Serif"
      FontSize        =   8.25
      FontStrikethru  =   0   'False
      FontUnderline   =   0   'False
      Height          =   285
      Index           =   0
      Left            =   450
      TabIndex        =   4
      Text            =   "Groupe permanent"
      Top             =   0
      Width           =   1695
   End
   Begin PictureBox PopulationGroupe 
      AutoRedraw      =   -1  'True
      DragMode        =   1  'Automatic
      Height          =   255
      Index           =   0
      Left            =   2145
      ScaleHeight     =   225
      ScaleWidth      =   975
      TabIndex        =   13
      TabStop         =   0   'False
      Top             =   0
      Width           =   1000
   End
   Begin CheckBox CocheProjectionGroupe 
      Height          =   255
      Index           =   1
      Left            =   0
      TabIndex        =   0
      Top             =   240
      Width           =   255
   End
   Begin TextBox CommentaireGroupe 
      FontBold        =   0   'False
      FontItalic      =   0   'False
      FontName        =   "MS Sans Serif"
      FontSize        =   8.25
      FontStrikethru  =   0   'False
      FontUnderline   =   0   'False
      Height          =   285
      Index           =   1
      Left            =   450
      TabIndex        =   5
      Top             =   240
      Width           =   1695
   End
   Begin PictureBox PopulationGroupe 
      AutoRedraw      =   -1  'True
      DragMode        =   1  'Automatic
      Height          =   255
      Index           =   1
      Left            =   2145
      ScaleHeight     =   225
      ScaleWidth      =   975
      TabIndex        =   12
      TabStop         =   0   'False
      Top             =   240
      Width           =   1000
   End
   Begin CheckBox CocheProjectionGroupe 
      Height          =   255
      Index           =   2
      Left            =   0
      TabIndex        =   1
      Top             =   480
      Width           =   255
   End
   Begin TextBox CommentaireGroupe 
      FontBold        =   0   'False
      FontItalic      =   0   'False
      FontName        =   "MS Sans Serif"
      FontSize        =   8.25
      FontStrikethru  =   0   'False
      FontUnderline   =   0   'False
      Height          =   285
      Index           =   2
      Left            =   450
      TabIndex        =   6
      Top             =   480
      Width           =   1695
   End
   Begin PictureBox PopulationGroupe 
      AutoRedraw      =   -1  'True
      DragMode        =   1  'Automatic
      Height          =   255
      Index           =   2
      Left            =   2145
      ScaleHeight     =   225
      ScaleWidth      =   975
      TabIndex        =   11
      TabStop         =   0   'False
      Top             =   480
      Width           =   1000
   End
   Begin CheckBox CocheProjectionGroupe 
      Height          =   255
      Index           =   3
      Left            =   0
      TabIndex        =   2
      Top             =   720
      Width           =   255
   End
   Begin TextBox CommentaireGroupe 
      FontBold        =   0   'False
      FontItalic      =   0   'False
      FontName        =   "MS Sans Serif"
      FontSize        =   8.25
      FontStrikethru  =   0   'False
      FontUnderline   =   0   'False
      Height          =   285
      Index           =   3
      Left            =   450
      TabIndex        =   7
      Top             =   720
      Width           =   1695
   End
   Begin PictureBox PopulationGroupe 
      AutoRedraw      =   -1  'True
      DragMode        =   1  'Automatic
      Height          =   255
      Index           =   3
      Left            =   2145
      ScaleHeight     =   225
      ScaleWidth      =   975
      TabIndex        =   10
      TabStop         =   0   'False
      Top             =   720
      Width           =   1000
   End
   Begin CheckBox CocheProjectionGroupe 
      Height          =   255
      Index           =   4
      Left            =   0
      TabIndex        =   3
      Top             =   960
      Width           =   255
   End
   Begin TextBox CommentaireGroupe 
      FontBold        =   0   'False
      FontItalic      =   0   'False
      FontName        =   "MS Sans Serif"
      FontSize        =   8.25
      FontStrikethru  =   0   'False
      FontUnderline   =   0   'False
      Height          =   285
      Index           =   4
      Left            =   450
      TabIndex        =   8
      Top             =   960
      Width           =   1695
   End
   Begin PictureBox PopulationGroupe 
      AutoRedraw      =   -1  'True
      DragMode        =   1  'Automatic
      Height          =   255
      Index           =   4
      Left            =   2145
      ScaleHeight     =   225
      ScaleWidth      =   975
      TabIndex        =   9
      TabStop         =   0   'False
      Top             =   960
      Width           =   1000
   End
   Begin Label EtiqSymboleGroupe 
      Alignment       =   2  'Center
      Caption         =   "j"
      FontBold        =   0   'False
      FontItalic      =   0   'False
      FontName        =   "Arial"
      FontSize        =   10.5
      FontStrikethru  =   0   'False
      FontUnderline   =   0   'False
      Height          =   255
      Index           =   10
      Left            =   240
      TabIndex        =   43
      Top             =   2400
      Width           =   255
   End
   Begin Label EtiqSymboleGroupe 
      Alignment       =   2  'Center
      Caption         =   "i"
      FontBold        =   0   'False
      FontItalic      =   0   'False
      FontName        =   "Arial"
      FontSize        =   10.5
      FontStrikethru  =   0   'False
      FontUnderline   =   0   'False
      Height          =   255
      Index           =   9
      Left            =   240
      TabIndex        =   39
      Top             =   2160
      Width           =   255
   End
   Begin Label EtiqSymboleGroupe 
      Alignment       =   2  'Center
      Caption         =   "h"
      FontBold        =   0   'False
      FontItalic      =   0   'False
      FontName        =   "Arial"
      FontSize        =   10.5
      FontStrikethru  =   0   'False
      FontUnderline   =   0   'False
      Height          =   255
      Index           =   8
      Left            =   240
      TabIndex        =   35
      Top             =   1920
      Width           =   255
   End
   Begin Label EtiqSymboleGroupe 
      Alignment       =   2  'Center
      Caption         =   "g"
      FontBold        =   0   'False
      FontItalic      =   0   'False
      FontName        =   "Arial"
      FontSize        =   10.5
      FontStrikethru  =   0   'False
      FontUnderline   =   0   'False
      Height          =   255
      Index           =   7
      Left            =   240
      TabIndex        =   31
      Top             =   1680
      Width           =   255
   End
   Begin Label EtiqSymboleGroupe 
      Alignment       =   2  'Center
      Caption         =   "f"
      FontBold        =   0   'False
      FontItalic      =   0   'False
      FontName        =   "Arial"
      FontSize        =   10.5
      FontStrikethru  =   0   'False
      FontUnderline   =   0   'False
      Height          =   255
      Index           =   6
      Left            =   240
      TabIndex        =   27
      Top             =   1440
      Width           =   255
   End
   Begin Label EtiqSymboleGroupe 
      Alignment       =   2  'Center
      Caption         =   "e"
      FontBold        =   0   'False
      FontItalic      =   0   'False
      FontName        =   "Arial"
      FontSize        =   10.5
      FontStrikethru  =   0   'False
      FontUnderline   =   0   'False
      Height          =   255
      Index           =   5
      Left            =   240
      TabIndex        =   23
      Top             =   1200
      Width           =   255
   End
   Begin Image fleche 
      Height          =   480
      Left            =   1680
      Picture         =   GROUPTRI.FRX:0302
      Top             =   2040
      Visible         =   0   'False
      Width           =   480
   End
   Begin Label EtiqSymboleGroupe 
      Alignment       =   2  'Center
      Caption         =   "*"
      FontBold        =   -1  'True
      FontItalic      =   0   'False
      FontName        =   "Arial"
      FontSize        =   18
      FontStrikethru  =   0   'False
      FontUnderline   =   0   'False
      Height          =   300
      Index           =   0
      Left            =   300
      TabIndex        =   19
      Top             =   0
      Width           =   135
   End
   Begin Label EtiqSymboleGroupe 
      Alignment       =   2  'Center
      Caption         =   "a"
      FontBold        =   0   'False
      FontItalic      =   0   'False
      FontName        =   "Arial"
      FontSize        =   10.5
      FontStrikethru  =   0   'False
      FontUnderline   =   0   'False
      Height          =   255
      Index           =   1
      Left            =   240
      TabIndex        =   18
      Top             =   240
      Width           =   255
   End
   Begin Label EtiqSymboleGroupe 
      Alignment       =   2  'Center
      Caption         =   "b"
      FontBold        =   0   'False
      FontItalic      =   0   'False
      FontName        =   "Arial"
      FontSize        =   10.5
      FontStrikethru  =   0   'False
      FontUnderline   =   0   'False
      Height          =   255
      Index           =   2
      Left            =   240
      TabIndex        =   17
      Top             =   480
      Width           =   255
   End
   Begin Label EtiqSymboleGroupe 
      Alignment       =   2  'Center
      Caption         =   "c"
      FontBold        =   0   'False
      FontItalic      =   0   'False
      FontName        =   "Arial"
      FontSize        =   10.5
      FontStrikethru  =   0   'False
      FontUnderline   =   0   'False
      Height          =   255
      Index           =   3
      Left            =   240
      TabIndex        =   16
      Top             =   720
      Width           =   255
   End
   Begin Label EtiqSymboleGroupe 
      Alignment       =   2  'Center
      Caption         =   "d"
      FontBold        =   0   'False
      FontItalic      =   0   'False
      FontName        =   "Arial"
      FontSize        =   10.5
      FontStrikethru  =   0   'False
      FontUnderline   =   0   'False
      Height          =   255
      Index           =   4
      Left            =   240
      TabIndex        =   15
      Top             =   960
      Width           =   255
   End
End

Sub CocheProjectionGroupe_Click (Index As Integer)
   On Error GoTo Traite_Erreurs3:
    'Afficher le groupe
    If flag = flag_chargement Then Exit Sub
      Select Case Index
         Case -1 To 0
            Exit Sub: 'Le groupe * est affiché en permanence, et le 0 jamais...
         Case Else
            'Affichage(Index) = -GroupTri!CocheProjectionGroupe(Index).Value         'Not (Affichage(Index))
            MDI!menu_projettegroupe(Index).Checked = -GroupTri!CocheProjectionGroupe(Index).Value
      End Select
   If NbMesSelect%(Index) > 0 Then RedessinStereo St!Stereo 'eh!
   AfficheListeGroupes
Exit Sub
Traite_Erreurs3:
   If Erreurs(Err, "TenseurFocStri / CocheProjectionGroupe_Click") Then Resume Next
End Sub

Sub CocheProjectionGroupe_DragDrop (Index As Integer, source As Control, X As Single, Y As Single)
   If GroupTri.WindowState = 1 Then Exit Sub
   DropFaille Index, source
End Sub

Sub CocheProjectionGroupe_DragOver (Index As Integer, source As Control, X As Single, Y As Single, state As Integer)
   Drague Index, source, state
End Sub

Sub CocheProjectionGroupe_MouseMove (Index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
   prompt "Projection de la (des) faille(s) du groupe " + symbolegroupedetri(Index) + "  {" + CommentaireGroupe(Index).Text + "}"
End Sub

Sub CommentaireGroupe_DblClick (Index As Integer)
   CommentaireGroupe(Index).SelStart = 0
   CommentaireGroupe(Index).SelLength = Len(CommentaireGroupe(Index).Text)
End Sub

Sub CommentaireGroupe_DragDrop (Index As Integer, source As Control, X As Single, Y As Single)
   If GroupTri.WindowState = 1 Then Exit Sub
   DropFaille Index, source
End Sub

Sub CommentaireGroupe_DragOver (Index As Integer, source As Control, X As Single, Y As Single, state As Integer)
   Drague Index, source, state
End Sub

Sub CommentaireGroupe_MouseMove (Index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
   prompt "Groupes de tri : commentaires"
End Sub

Sub Drague (Index As Integer, source As Control, etat As Integer)
   On Error GoTo Traite_Erreurs1:
   If WindowState = REDUIT Then Exit Sub
   Select Case etat
      Case 0     'entrée
         Select Case (source.Parent Is GroupTri) And (Val(source.Tag) = Index)
            Case True
               prompt "Projection de la (des) faille(s) du groupe " + symbolegroupedetri(Index) + "  {" + CommentaireGroupe(Index).Text + "}"
            Case Else
               prompt "Tri de la (des) faille(s) dans le groupe " + symbolegroupedetri(Index) + "  {" + CommentaireGroupe(Index).Text + "}"
               CommentaireGroupe(Index).ForeColor = (CouleurGroupe(Index) And GroupTri.BackColor)'xor (CommentaireGroupe(Index).BackColor)
               CommentaireGroupe(Index).BackColor = CouleurGroupe(Index)' PopulationGroupe(Index).FillColor
               '(CouleurGroupe(Index) And GroupTri.BackColor)
               'Source.DragIcon = fleche.Picture
         End Select
      Case 1'sortie
         prompt "Drag && drop vers un groupe de tri pour trier la(les) faille(s)"
         CommentaireGroupe(Index).BackColor = FOND_FENETRE
         CommentaireGroupe(Index).ForeColor = TEXTE_FENETRE
         'prompt  "Déselection de la (des) mesure(s)"
         'Source.DragIcon = poubelle.Picture
      Case Else
   End Select
Exit Sub
Traite_Erreurs1:
   If Erreurs(Err, "TenseurFocStri / Drague") Then Resume Next
End Sub

Sub EtiqSymboleGroupe_DragDrop (Index As Integer, source As Control, X As Single, Y As Single)
   If GroupTri.WindowState = 1 Then Exit Sub
   DropFaille Index, source
End Sub

Sub EtiqSymboleGroupe_DragOver (Index As Integer, source As Control, X As Single, Y As Single, etat As Integer)
  Drague Index, source, etat
  '  glou1 = EtiqSymboleGroupe(Index).ForeColor
  '  glou2 = EtiqSymboleGroupe(Index).BackColor
  '
  '  EtiqSymboleGroupe(Index).BackColor = glou1
  '  EtiqSymboleGroupe(Index).ForeColor = glou2
End Sub

Sub EtiqSymboleGroupe_MouseMove (Index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
   prompt "Groupes de tri, coches de projection, symbole, population"
End Sub

Sub Form_Load ()
   On Error GoTo Traite_Erreurs4:
   Width = PopulationGroupe(NbGroupesDeTri).Width + PopulationGroupe(NbGroupesDeTri).Left + 30
   Height = CommentaireGroupe(NbGroupesDeTri).Height + CommentaireGroupe(NbGroupesDeTri).Top + HauteurBarreTitre + 30
      For groupe = 0 To NbGroupesDeTri
        ' Label_Population_Groupe(groupe).ForeColor = CouleurGroupe(groupe)
         PopulationGroupe(groupe).Tag = groupe
         PopulationGroupe(groupe).DragIcon = fleche.Picture
         EtiqSymboleGroupe(groupe).Caption = Chr$(groupe + 96)
      Next
      EtiqSymboleGroupe(0).Caption = "*"
Exit Sub
Traite_Erreurs4:
   If Erreurs(Err, "Grouptri / Form_Load") Then Resume Next
End Sub

Sub Form_MouseMove (Button As Integer, Shift As Integer, X As Single, Y As Single)
   prompt "Groupes de tri, coches de projection, symbole, population"
End Sub

Sub Form_QueryUnload (Cancel As Integer, unloadmode As Integer)
   If unloadmode <> 1 Then Cancel = True
End Sub

Sub PopulationGroupe_DragDrop (Index As Integer, source As Control, X As Single, Y As Single)
   If GroupTri.WindowState = 1 Then Exit Sub
   DropFaille Index, source
End Sub

Sub PopulationGroupe_DragOver (Index As Integer, source As Control, X As Single, Y As Single, state As Integer)
  Drague Index, source, state
End Sub

Sub PopulationGroupe_MouseMove (Index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
   prompt "Groupes de tri, coches de projection, symbole, population"
End Sub

